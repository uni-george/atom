import{b as C,i as le,C as j}from"./Stack-0SagYPpj.js";import{a as u}from"./chunk-QMGIS6GS-IYNE5lo-.js";import{u as se}from"./useEnhancedEffect-DafSaGyV.js";function U(t,e,r=(n,l)=>n===l){return t.length===e.length&&t.every((n,l)=>r(n,e[l]))}function ie(t,e){return t===e}const H={},W=()=>{};function A(t,e){const r=C({},t);return Object.keys(e).forEach(n=>{e[n]!==void 0&&(r[n]=e[n])}),r}function ue(t){const{nextState:e,initialState:r,stateComparers:n,onStateChange:l,controlledProps:s,lastActionRef:i}=t,m=u.useRef(r);u.useEffect(()=>{if(i.current===null)return;const c=A(m.current,s);Object.keys(e).forEach(f=>{var I;const o=(I=n[f])!=null?I:ie,h=e[f],a=c[f];if(a==null&&h!=null||a!=null&&h==null||a!=null&&h!=null&&!o(h,a)){var d,b;l?.((d=i.current.event)!=null?d:null,f,h,(b=i.current.type)!=null?b:"",e)}}),m.current=e,i.current=null},[m,e,i,l,n,s])}function oe(t){const e=u.useRef(null),{reducer:r,initialState:n,controlledProps:l=H,stateComparers:s=H,onStateChange:i=W,actionContext:m}=t;u.useRef(l);const c=u.useCallback((h,a)=>{e.current=a;const d=A(h,l);return r(d,a)},[l,r]),[f,I]=u.useReducer(c,n),o=u.useCallback(h=>{I(C({},h,{context:m}))},[m]);return ue({nextState:f,initialState:n,stateComparers:s??H,onStateChange:i??W,controlledProps:l,lastActionRef:e}),[A(f,l),o]}const x={blur:"list:blur",itemClick:"list:itemClick",itemHover:"list:itemHover",itemsChange:"list:itemsChange",keyDown:"list:keyDown",resetHighlight:"list:resetHighlight",highlightLast:"list:highlightLast",textNavigation:"list:textNavigation",clearSelection:"list:clearSelection"};function ae(t,e,r,n,l,s){if(r.length===0||!n&&r.every((m,c)=>l(m,c)))return-1;let i=t;for(;;){if(!s&&e==="next"&&i===r.length||!s&&e==="previous"&&i===-1)return-1;if(n?!1:l(r[i],i))i+=e==="next"?1:-1,s&&(i=(i+r.length)%r.length);else return i}}function v(t,e,r){var n;const{items:l,isItemDisabled:s,disableListWrap:i,disabledItemsFocusable:m,itemComparer:c,focusManagement:f}=r,I=f==="DOM"?0:-1,o=l.length-1,h=t==null?-1:l.findIndex(k=>c(k,t));let a,d,b=!i;switch(e){case"reset":if(I===-1)return null;a=0,d="next",b=!1;break;case"start":a=0,d="next",b=!1;break;case"end":a=o,d="previous",b=!1;break;default:{const k=h+e;k<0?!b&&h!==-1||Math.abs(e)>1?(a=0,d="next"):(a=o,d="previous"):k>o?!b||Math.abs(e)>1?(a=o,d="previous"):(a=0,d="next"):(a=k,d=e>=0?"next":"previous")}}const y=ae(a,d,l,m,s,b);return y===-1&&t!==null&&!s(t,h)?t:(n=l[y])!=null?n:null}function ce(t,e,r,n){return r==="none"?[]:r==="single"?n(e[0],t)?e:[t]:e.some(l=>n(l,t))?e.filter(l=>!n(l,t)):[...e,t]}function q(t,e,r){const{itemComparer:n,isItemDisabled:l,selectionMode:s,items:i}=r,{selectedValues:m}=e,c=i.findIndex(I=>n(t,I));if(l(t,c))return e;const f=ce(t,m,s,n);return C({},e,{selectedValues:f,highlightedValue:t})}function he(t,e,r){const n=e.highlightedValue,{orientation:l,pageSize:s}=r;switch(t){case"Home":return C({},e,{highlightedValue:v(n,"start",r)});case"End":return C({},e,{highlightedValue:v(n,"end",r)});case"PageUp":return C({},e,{highlightedValue:v(n,-s,r)});case"PageDown":return C({},e,{highlightedValue:v(n,s,r)});case"ArrowUp":if(l!=="vertical")break;return C({},e,{highlightedValue:v(n,-1,r)});case"ArrowDown":if(l!=="vertical")break;return C({},e,{highlightedValue:v(n,1,r)});case"ArrowLeft":{if(l==="vertical")break;return C({},e,{highlightedValue:v(n,l==="horizontal-ltr"?-1:1,r)})}case"ArrowRight":{if(l==="vertical")break;return C({},e,{highlightedValue:v(n,l==="horizontal-ltr"?1:-1,r)})}case"Enter":case" ":return e.highlightedValue===null?e:q(e.highlightedValue,e,r)}return e}function de(t,e){return e.focusManagement==="DOM"?t:C({},t,{highlightedValue:null})}function ge(t,e,r){var n;const l=(n=r(t))==null?void 0:n.trim().toLowerCase();return!l||l.length===0?!1:l.indexOf(e)===0}function fe(t,e,r){const{items:n,isItemDisabled:l,disabledItemsFocusable:s,getItemAsString:i}=r,m=e.length>1;let c=m?t.highlightedValue:v(t.highlightedValue,1,r);for(let f=0;f<n.length;f+=1){if(!c||!m&&t.highlightedValue===c)return t;if(ge(c,e,i)&&(!l(c,n.indexOf(c))||s))return C({},t,{highlightedValue:c});c=v(c,1,r)}return t}function me(t,e,r,n){var l;const{itemComparer:s,focusManagement:i}=n;let m=null;if(r.highlightedValue!=null){var c;m=(c=t.find(o=>s(o,r.highlightedValue)))!=null?c:null}else i==="DOM"&&e.length===0&&(m=v(null,"reset",n));const I=((l=r.selectedValues)!=null?l:[]).filter(o=>t.some(h=>s(h,o)));return C({},r,{highlightedValue:m,selectedValues:I})}function Ce(t,e){return C({},t,{highlightedValue:v(null,"reset",e)})}function pe(t,e){return C({},t,{highlightedValue:v(null,"end",e)})}function Ie(t,e){return C({},t,{selectedValues:[],highlightedValue:v(null,"reset",e)})}function be(t,e){const{type:r,context:n}=e;switch(r){case x.keyDown:return he(e.key,t,n);case x.itemClick:return q(e.item,t,n);case x.blur:return de(t,n);case x.textNavigation:return fe(t,e.searchString,n);case x.itemsChange:return me(e.items,e.previousItems,t,n);case x.resetHighlight:return Ce(t,n);case x.highlightLast:return pe(t,n);case x.clearSelection:return Ie(t,n);default:return t}}const xe=500;function Se(t){const e=u.useRef({searchString:"",lastTime:null});return u.useCallback(r=>{if(r.key.length===1&&r.key!==" "){const n=e.current,l=r.key.toLowerCase(),s=performance.now();n.searchString.length>0&&n.lastTime&&s-n.lastTime>xe?n.searchString=l:(n.searchString.length!==1||l!==n.searchString)&&(n.searchString+=l),n.lastTime=s,t(n.searchString,r)}},[t])}const G={},we=()=>{},ve=(t,e)=>t===e,ke=()=>!1,Ve=t=>typeof t=="string"?t:String(t),ye=()=>({highlightedValue:null,selectedValues:[]});function He(t){const{controlledProps:e=G,disabledItemsFocusable:r=!1,disableListWrap:n=!1,focusManagement:l="activeDescendant",getInitialState:s=ye,getItemDomElement:i,getItemId:m,isItemDisabled:c=ke,rootRef:f,onStateChange:I=we,items:o,itemComparer:h=ve,getItemAsString:a=Ve,onChange:d,onHighlightChange:b,onItemsChange:y,orientation:k="vertical",pageSize:L=5,reducerActionContext:N=G,selectionMode:_="single",stateReducer:$,componentName:Ee="useList"}=t,B=u.useRef(null),F=le(f,B),R=u.useCallback((p,g,S)=>{if(b?.(p,g,S),l==="DOM"&&g!=null&&(S===x.itemClick||S===x.keyDown||S===x.textNavigation)){var w;i==null||(w=i(g))==null||w.focus()}},[i,b,l]),E=u.useMemo(()=>({highlightedValue:h,selectedValues:(p,g)=>U(p,g,h)}),[h]),J=u.useCallback((p,g,S,w,M)=>{switch(I?.(p,g,S,w,M),g){case"highlightedValue":R(p,S,w);break;case"selectedValues":d?.(p,S,w);break}},[R,d,I]),K=u.useMemo(()=>({disabledItemsFocusable:r,disableListWrap:n,focusManagement:l,isItemDisabled:c,itemComparer:h,items:o,getItemAsString:a,onHighlightChange:R,orientation:k,pageSize:L,selectionMode:_,stateComparers:E}),[r,n,l,c,h,o,a,R,k,L,_,E]),Y=s(),X=$??be,Q=u.useMemo(()=>C({},N,K),[N,K]),[O,V]=oe({reducer:X,actionContext:Q,initialState:Y,controlledProps:e,stateComparers:E,onStateChange:J}),{highlightedValue:D,selectedValues:P}=O,Z=Se((p,g)=>V({type:x.textNavigation,event:g,searchString:p})),T=u.useRef([]);u.useEffect(()=>{U(T.current,o,h)||(V({type:x.itemsChange,event:null,items:o,previousItems:T.current}),T.current=o,y?.(o))},[o,h,V,y]);const ee=p=>g=>{var S;if((S=p.onKeyDown)==null||S.call(p,g),g.defaultMuiPrevented)return;const w=["Home","End","PageUp","PageDown"];k==="vertical"?w.push("ArrowUp","ArrowDown"):w.push("ArrowLeft","ArrowRight"),l==="activeDescendant"&&w.push(" ","Enter"),w.includes(g.key)&&g.preventDefault(),V({type:x.keyDown,key:g.key,event:g}),Z(g)},te=p=>g=>{var S,w;(S=p.onBlur)==null||S.call(p,g),!g.defaultMuiPrevented&&((w=B.current)!=null&&w.contains(g.relatedTarget)||V({type:x.blur,event:g}))},ne=(p={})=>{const g=j(p);return C({},p,{"aria-activedescendant":l==="activeDescendant"&&D!=null?m(D):void 0,tabIndex:l==="DOM"?-1:0,ref:F},g,{onBlur:te(g),onKeyDown:ee(g)})},z=u.useCallback(p=>{const g=(P??[]).some(M=>M!=null&&h(p,M)),S=D!=null&&h(p,D);return{focusable:l==="DOM",highlighted:S,selected:g}},[h,P,D,l]),re=u.useMemo(()=>({dispatch:V,getItemState:z}),[V,z]);return u.useDebugValue({state:O}),{contextValue:re,dispatch:V,getRootProps:ne,rootRef:F,state:O}}const De=u.createContext(null);function Ae(t){const{handlePointerOverEvents:e=!1,item:r}=t,n=u.useContext(De);if(!n)throw new Error("useListItem must be used within a ListProvider");const{dispatch:l,getItemState:s}=n,{highlighted:i,selected:m,focusable:c}=s(r),f=u.useCallback(a=>d=>{var b;(b=a.onClick)==null||b.call(a,d),!d.defaultPrevented&&l({type:x.itemClick,item:r,event:d})},[l,r]),I=u.useCallback(a=>d=>{var b;(b=a.onMouseOver)==null||b.call(a,d),!d.defaultPrevented&&l({type:x.itemHover,item:r,event:d})},[l,r]);let o;return c&&(o=i?0:-1),{getRootProps:(a={})=>{const d=j(a);return C({},a,{onClick:f(d),onPointerOver:e?I(d):void 0,tabIndex:o})},highlighted:i,selected:m}}const Re=u.createContext(null);function Me(t){const e=Array.from(t.keys()).map(r=>{const n=t.get(r);return{key:r,subitem:n}});return e.sort((r,n)=>{const l=r.subitem.ref.current,s=n.subitem.ref.current;return l===null||s===null||l===s?0:l.compareDocumentPosition(s)&Node.DOCUMENT_POSITION_PRECEDING?1:-1}),new Map(e.map(r=>[r.key,r.subitem]))}function Le(){const[t,e]=u.useState(new Map),r=u.useRef(new Set),n=u.useCallback(function(f){r.current.delete(f),e(I=>{const o=new Map(I);return o.delete(f),o})},[]),l=u.useCallback(function(f,I){let o;return typeof f=="function"?o=f(r.current):o=f,r.current.add(o),e(h=>{const a=new Map(h);return a.set(o,I),a}),{id:o,deregister:()=>n(o)}},[n]),s=u.useMemo(()=>Me(t),[t]),i=u.useCallback(function(f){return Array.from(s.keys()).indexOf(f)},[s]);return{contextValue:u.useMemo(()=>({getItemIndex:i,registerItem:l,totalSubitemCount:t.size}),[i,l,t.size]),subitems:s}}function Ne(t,e){const r=u.useContext(Re);if(r===null)throw new Error("useCompoundItem must be used within a useCompoundParent");const{registerItem:n}=r,[l,s]=u.useState(typeof t=="function"?void 0:t);return se(()=>{const{id:i,deregister:m}=n(t,e);return s(i),m},[n,e,t]),{id:l,index:l!==void 0?r.getItemIndex(l):-1,totalItemCount:r.totalSubitemCount}}function _e(t,e){return function(n={}){const l=C({},n,t(n));return C({},l,e(l))}}export{Re as C,De as L,Ne as a,x as b,_e as c,Le as d,He as e,q as h,be as l,v as m,Ae as u};
