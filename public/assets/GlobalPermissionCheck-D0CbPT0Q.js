import{a as s,p as y,o as e}from"./chunk-QMGIS6GS-DtoyICqO.js";import{A as C}from"./APIManager-B2UZ4w5a.js";import{E,S as P}from"./ErrorCard-KNXIau_K.js";import{S as I}from"./SelfPermissionCacheContext-DOzmS9ty.js";import{S as r,T as u}from"./Stack-JCjNLC7t.js";import{L as w}from"./LinearProgress-BtLiBgIz.js";const k=s.createContext(void 0);function L(){const t=s.useContext(k);if(!t)throw new Error("Dashboard navigation context is not yet populated.");return t}const M={home:0,users:1,images:2,files:3,userGroups:4,content:5,pages:6,elements:7,components:8},W=({permissions:t,centerVertically:h,start:p,end:x,message:g,messageLevel:v,redirect:c,children:b,discreet:S=!1})=>{const[o,l]=s.useState(void 0),[i,d]=s.useState(!0),[n,m]=s.useState(!1),j=y(),f=s.useContext(I);return s.useEffect(()=>{f?(l(f),d(!1)):C.permission.me().then(a=>{l(a)}).catch(()=>{throw new Error("Server could not be accessed.")}).finally(()=>{d(!1)})},[]),s.useEffect(()=>{o&&(t.every(a=>o[a]||!1)?m(!0):m(!1))},[o]),!i&&!n&&c&&j(c),(i||!n)&&S?e.jsx(e.Fragment,{}):i||!n?e.jsx(r,{justifyContent:"center",alignItems:"center",width:"100%",height:h?"100%":"unset",children:i?e.jsx(N,{}):e.jsxs(r,{children:[p||null,e.jsx(E,{title:"no access",sx:{maxWidth:"400px"},code:"ERR_INSUFFICIENT_PERMISSION",children:e.jsx(u,{level:v||"body-md",children:g||"apologies, but you don't have the sufficient permissions to access this feature. if you think this is a mistake, please contact an administrator."})}),x||null]})}):b},N=()=>e.jsx(P,{variant:"outlined",sx:{p:2,borderRadius:t=>t.radius.md},children:e.jsxs(r,{direction:"column",alignItems:"center",gap:2,children:[e.jsx(u,{level:"body-xs",sx:{"&::after":{content:"'\\2026'",display:"inline-block",verticalAlign:"bottom",overflow:"hidden",animation:"ellipsis steps(4, end) 1500ms infinite",width:0},"@keyframes ellipsis":{to:{width:"12px"}}},children:"checking permissions"}),e.jsx(w,{sx:{minWidth:"130px"}})]})});export{M as D,W as G,k as a,L as u};
