import{a,o as e,z as v,A as S,w as y,y as L}from"./chunk-QMGIS6GS-Cu-6P6Bw.js";import{A as x}from"./APIManager-BmgSMlkF.js";import{E as C}from"./ErrorCard-gkbNXzDf.js";import{F as m,a as p,I as g,V as E,b as I,B as u,R as b,i as D,D as R,A as j,W as P,G as M,c as k}from"./interleave-DeQMC6fJ.js";import{I as A,C as N,L as O}from"./createSvgIcon-DY0Mft1u.js";import{S as T}from"./Small-BRu3RRzM.js";import{S as i,j as l}from"./Stack-DhFApu8q.js";import{g as W}from"./defaultMeta-DeBRnKiC.js";const _=()=>{const[t,o]=a.useState(!1);return e.jsxs("form",{onSubmit:s=>{s.preventDefault();const n=s.currentTarget.elements;n.username.value,n.password.value},children:[e.jsxs(m,{required:!0,children:[e.jsx(p,{children:"username"}),e.jsx(g,{type:"text",name:"username",autoComplete:"username"})]}),e.jsxs(m,{required:!0,sx:{mt:-1},children:[e.jsx(p,{children:"password"}),e.jsx(g,{type:t?"text":"password",name:"password",autoComplete:"new-password",endDecorator:e.jsx(A,{onClick:()=>o(!t),children:t?e.jsx(E,{}):e.jsx(I,{})})})]}),e.jsx(u,{type:"submit",fullWidth:!0,sx:{mt:2},children:"sign up"})]})},F=()=>{const[t,o]=a.useState(),[s,n]=a.useState(void 0),[f,c]=a.useState(!0),h=()=>{x.auth.getSignupTypes().then(r=>{r?.length?o(r):n("ERR_NO_SERVER_LOGIN_CONFIGS"),c(!1)}).catch(r=>{n(r),c(!1)})},w=()=>{o(void 0),n(void 0),c(!0)};return a.useEffect(()=>{h()},[]),[f].some(r=>r)?e.jsx(i,{direction:"row",justifyContent:"center",children:e.jsx(N,{variant:"soft"})}):s?e.jsxs(i,{gap:4,children:[e.jsx(C,{code:s,children:e.jsx(l,{level:"body-md",children:"either i can't load the authentication methods, or there are none set up. please check your connection, then contact the owner of this instance of atom."})}),e.jsx(u,{size:"sm",color:"primary",startDecorator:e.jsx(b,{}),onClick:()=>{w(),h()},children:"retry"})]}):e.jsxs(i,{gap:4,children:[e.jsxs(i,{gap:1,children:[e.jsx(l,{component:"h1",level:"h3",children:"sign up"}),e.jsxs(l,{level:"body-sm",component:"div",children:["already have an account?"," ",e.jsx(v,{to:"/login",children:e.jsx(O,{component:"div",children:"login here!"})})]})]}),D([...new Set(t)].map(r=>{switch(r){case"google":return e.jsx(d,{method:r,children:e.jsx(u,{variant:"soft",color:"neutral",fullWidth:!0,startDecorator:e.jsx(M,{}),onClick:()=>{document.location.href="/auth/signup/google"},children:"sign up with google"},r)});case"local":return e.jsx(d,{method:r,children:e.jsx(_,{})});default:return e.jsx(d,{method:r,children:e.jsxs(j,{startDecorator:e.jsx(P,{}),color:"warning",variant:"outlined",children:["unsupported authentication method: ",r]},r)})}}),e.jsx(R,{children:"or"}))]})},d=({method:t,children:o})=>{const[s,n]=S();return e.jsxs(i,{gap:1,children:[o,s.get("error")==t?e.jsx(j,{startDecorator:e.jsx(k,{}),sx:{alignItems:"flex-start"},variant:"soft",color:"danger",children:e.jsxs("div",{children:[e.jsx("div",{children:"couldn't sign up"}),e.jsx(l,{level:"body-sm",color:"danger",textTransform:"lowercase",children:s.get("errorMessage")||"something happened and i couldn't sign you up"}),e.jsx(T,{textTransform:"lowercase",children:s.get("errorCode")||"ERR_UNKNOWN"})]})}):null]})};function J({}){return W("sign up - atom")}async function Q(){return await x.auth.loggedIn()?L("/dashboard"):{}}const X=y(function({loaderData:o}){return e.jsx(F,{})});export{Q as clientLoader,X as default,J as meta};
