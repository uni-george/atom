import{a,A as U,o as e,p as L,w as N}from"./chunk-QMGIS6GS-DtoyICqO.js";import{A as j,G as W}from"./APIManager-B2UZ4w5a.js";import{c as E,P as z,S as F}from"./Paginator-B2yTVwJH.js";import{m as G}from"./millify-CTTu5PsY.js";import{n as S}from"./noResultsKaomoji-CX4veuCQ.js";import{S as p,T as x,B as C}from"./Stack-JCjNLC7t.js";import{S as H}from"./ErrorCard-KNXIau_K.js";import{T as K,K as P}from"./KeyboardArrowDownRounded-B5lcQ9S4.js";import{I as O}from"./ImageRounded-CVoJPFjR.js";import{L as w,C as X}from"./Link-B5kWyCnV.js";import{A as Y}from"./Avatar-C_jncssy.js";import{D as _,s as q}from"./setDashboardNavigationContext-BWyQ02lE.js";import{G as J,D as Q}from"./GlobalPermissionCheck-D0CbPT0Q.js";import{v as V}from"./index-D9GkzZBy.js";import{D as Z}from"./LinearProgress-BtLiBgIz.js";import{F as D,a as R,I as $}from"./FormLabel-C-0_FOk2.js";import{S as ee,a as u}from"./Select-DBRM7IsL.js";import{g as te}from"./defaultMeta-DeBRnKiC.js";import"./createSvgIcon-DQe4S7v3.js";import"./Button-31T2a4ki.js";import"./buttonClasses-Cy5i3mdA.js";import"./Popper-DEf3PWv7.js";import"./index-Cwr4DWDF.js";import"./Small-BFUFtg_I.js";import"./createSvgIcon-D815fwpB.js";import"./SelfPermissionCacheContext-DOzmS9ty.js";import"./dividerClasses-BlvlTBdT.js";import"./ListItemButton-C-bDkTqT.js";const se=({nameSearch:s,limit:t,page:n=1,setPage:d})=>{const[r,g]=a.useState(void 0),[i,h]=a.useState(!0),[o,f]=a.useState(0),[c,v]=a.useState("ascending"),[m,b]=a.useState("name"),[I,k]=a.useState(0),[y,T]=U(),A=E(async()=>{h(!0),t||=10;let l={sortDirection:c,sortBy:m,name:s||void 0,limit:t,offset:t*(n-1)},M=await j.user.search(l),B=await j.user.count(l);g(M),f(B||0),k(Math.floor(Math.random()*S.length)),h(!1)},500,{leading:!1});return a.useEffect(()=>{h(!0),A()},[s,t,n,m,c]),a.useEffect(()=>{if(!i&&(n-1)*(t||0)+1>o){let l=Math.max(1,Math.ceil(o/(t||10)));d?.(l),y.set("page",l.toString()),T(y)}},[i,n,o,t]),e.jsxs(p,{gap:2,children:[e.jsxs(H,{variant:"outlined",sx:{width:1,borderRadius:"sm",flexShrink:1,overflow:"auto",minHeight:0},children:[e.jsxs(K,{stickyHeader:!0,hoverRow:!0,sx:{"--TableCell-headBackground":"var(--atom-palette-background-level1)","--TableRow-hoverBackground":"var(--atom-palette-background-level1)","--Table-headerUnderlineThickness":"1px","--TableCell-paddingY":"8px","--TableCell-paddingX":"8px"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:60,padding:"12px 6px"},children:e.jsx(p,{justifyContent:"center",alignItems:"center",sx:{height:1,"& > svg":{color:"text.secondary"}},children:e.jsx(O,{})})}),e.jsx("th",{style:{padding:"12px 6px"},children:e.jsx(w,{underline:"none",color:"neutral",component:"button",onClick:()=>{m=="name"&&v(c=="ascending"?"descending":"ascending"),b("name")},endDecorator:m=="name"?e.jsx(P,{}):null,sx:[{fontWeight:"lg","& svg":{transition:"0.2s",transform:c=="descending"?"rotate(0deg)":"rotate(180deg)"}}],textColor:"text.secondary",children:"name"})}),e.jsx("th",{style:{padding:"12px 6px"},children:e.jsx(w,{underline:"none",color:"neutral",component:"button",endDecorator:m=="id"?e.jsx(P,{}):null,sx:{fontWeight:"lg","& svg":{transition:"0.2s",transform:c=="descending"?"rotate(0deg)":"rotate(180deg)"}},textColor:"text.secondary",onClick:()=>{m=="id"&&v(c=="ascending"?"descending":"ascending"),b("id")},children:"id"})})]})}),e.jsx("tbody",{children:i?null:r?.map(l=>e.jsx(re,{user:l},l.id))})]}),i?e.jsx(p,{justifyContent:"center",alignItems:"center",width:1,height:1,sx:{p:3},children:e.jsx(X,{})}):r?.length?null:e.jsxs(p,{sx:{p:3},children:[e.jsx(x,{sx:{textAlign:"center",mb:2},level:"h3",textColor:"text.tertiary",component:"code",children:S[I]}),e.jsx(x,{sx:{textAlign:"center"},level:"body-md",textColor:"text.tertiary",children:"no users"})]})]}),i?null:e.jsx(z,{page:n,setPage:d,numPages:Math.ceil(o/(t||10)),includeButtons:!0}),i?null:e.jsxs(x,{textAlign:"center",level:"body-xs",children:["showing ",(n-1)*(t||0)+1," to ",Math.min((n-1)*(t||0)+(t||0),o)," of ",G(o,{precision:2})," users"]})]})},re=({user:s})=>{const[t,n]=a.useState(void 0),d=L();return a.useEffect(()=>{n(void 0),s.avatarID&&j.image.getURL(s.avatarID||"").then(r=>{n(r)})},[s.avatarID]),e.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>{d(s.id)},children:[e.jsx("td",{children:e.jsx(p,{direction:"row",justifyContent:"center",children:e.jsx(Y,{src:t,children:s.name?.slice?.(0,1)?.toUpperCase()})})}),e.jsx("td",{children:s.name?e.jsx(x,{level:"body-sm",textColor:"text.primary",noWrap:!0,overflow:"hidden",children:s.name}):e.jsx(x,{level:"body-sm",textColor:"text.tertiary",children:"<unnamed user>"})}),e.jsx("td",{children:e.jsx(x,{level:"body-sm",textColor:"text.tertiary",noWrap:!0,overflow:"hidden",children:s.id})})]})},ae=()=>{const[s,t]=a.useState(void 0),[n,d]=a.useState(10),[r,g]=U(),[i,h]=a.useState(1);return a.useEffect(()=>{r.get("limit")&&V.isInt(r.get("limit")||"")&&d(parseInt(r.get("limit")||"")||0),r.get("name")&&t(r.get("name")||void 0)},[]),e.jsxs(e.Fragment,{children:[e.jsx(Z,{}),e.jsx(_,{children:e.jsx(J,{centerVertically:!0,permissions:[W.ManageUsers],children:e.jsxs(C,{sx:{minHeight:1,minWidth:1},children:[e.jsxs(C,{sx:{borderRadius:"sm",pb:2,display:"flex",flexWrap:"wrap",gap:1.5,"& > *":{minWidth:{xs:"120px",md:"160px"}}},children:[e.jsxs(D,{size:"sm",sx:{flex:1},children:[e.jsx(R,{children:"search for user"}),e.jsx($,{size:"sm",placeholder:"search",startDecorator:e.jsx(F,{}),value:s,onChange:o=>{t(o.target.value),r.set("name",o.target.value),g(r)}})]}),e.jsxs(D,{size:"sm",children:[e.jsx(R,{children:"users per page"}),e.jsxs(ee,{size:"sm",slotProps:{button:{sx:{whiteSpace:"nowrap"}}},value:n,onChange:(o,f)=>{d(f||10),r.set("limit",f?.toString()||""),g(r)},children:[e.jsx(u,{value:5,children:"5"}),e.jsx(u,{value:10,children:"10"}),e.jsx(u,{value:15,children:"15"}),e.jsx(u,{value:20,children:"20"}),e.jsx(u,{value:25,children:"25"})]})]})]}),e.jsx(se,{nameSearch:s,limit:n,page:i,setPage:h})]})})})]})};function Me({}){return te("users - atom")}const Be=N(function({}){return q({route:[{name:"users",href:"/dashboard/users"}],sidebarActiveTab:Q.users,title:"users"}),e.jsx(ae,{})});export{Be as default,Me as meta};
